import{S as re,i as ne,s as ie,e as a,t as O,k as L,c as r,a as v,h as V,d as f,m as P,b as t,g as ue,F as e,M as N,L as z,N as ce,G as ae,O as pe,K as Y,v as de}from"../chunks/vendor-022b7721.js";import{t as he,i as fe,p as Z}from"../chunks/useToken-04409780.js";function me(u){let c,s,d,b,S,y,l,_,n,I,j,B,m,C,E,k,T,D,o,i,q,g,U,x,H,w,Q,A,W,X,$;return{c(){c=a("form"),s=a("div"),d=a("div"),b=a("label"),S=O("Institution"),y=L(),l=a("input"),_=L(),n=a("div"),I=a("label"),j=O("country"),B=L(),m=a("input"),C=L(),E=a("div"),k=a("div"),T=a("label"),D=O("city"),o=L(),i=a("input"),q=L(),g=a("div"),U=a("label"),x=O("postcode"),H=L(),w=a("input"),Q=L(),A=a("button"),W=O("Submit"),this.h()},l(p){c=r(p,"FORM",{});var h=v(c);s=r(h,"DIV",{class:!0});var M=v(s);d=r(M,"DIV",{class:!0});var R=v(d);b=r(R,"LABEL",{for:!0});var ee=v(b);S=V(ee,"Institution"),ee.forEach(f),y=P(R),l=r(R,"INPUT",{class:!0,type:!0,placeholder:!0}),R.forEach(f),_=P(M),n=r(M,"DIV",{class:!0});var F=v(n);I=r(F,"LABEL",{for:!0});var te=v(I);j=V(te,"country"),te.forEach(f),B=P(F),m=r(F,"INPUT",{class:!0,type:!0,placeholder:!0}),F.forEach(f),M.forEach(f),C=P(h),E=r(h,"DIV",{class:!0});var G=v(E);k=r(G,"DIV",{class:!0});var J=v(k);T=r(J,"LABEL",{for:!0});var se=v(T);D=V(se,"city"),se.forEach(f),o=P(J),i=r(J,"INPUT",{class:!0,type:!0,placeholder:!0}),J.forEach(f),q=P(G),g=r(G,"DIV",{class:!0});var K=v(g);U=r(K,"LABEL",{for:!0});var oe=v(U);x=V(oe,"postcode"),oe.forEach(f),H=P(K),w=r(K,"INPUT",{class:!0,type:!0,placeholder:!0}),K.forEach(f),G.forEach(f),Q=P(h),A=r(h,"BUTTON",{class:!0,type:!0});var le=v(A);W=V(le,"Submit"),le.forEach(f),h.forEach(f),this.h()},h(){t(b,"for","exampleEmailInput"),t(l,"class","u-full-width"),t(l,"type","text"),t(l,"placeholder","Birkbeck College"),t(d,"class","six columns"),t(I,"for","exampleEmailInput"),t(m,"class","u-full-width"),t(m,"type","text"),t(m,"placeholder","England, UK"),t(n,"class","six columns"),t(s,"class","row"),t(T,"for","exampleEmailInput"),t(i,"class","u-full-width"),t(i,"type","text"),t(i,"placeholder","London"),t(k,"class","six columns"),t(U,"for","exampleEmailInput"),t(w,"class","u-full-width"),t(w,"type","text"),t(w,"placeholder","N1 6RU"),t(g,"class","six columns"),t(E,"class","row"),t(A,"class","button-primary"),t(A,"type","submit"),A.value="Submit"},m(p,h){ue(p,c,h),e(c,s),e(s,d),e(d,b),e(b,S),e(d,y),e(d,l),N(l,u[0]),e(s,_),e(s,n),e(n,I),e(I,j),e(n,B),e(n,m),N(m,u[1]),e(c,C),e(c,E),e(E,k),e(k,T),e(T,D),e(k,o),e(k,i),N(i,u[2]),e(E,q),e(E,g),e(g,U),e(U,x),e(g,H),e(g,w),N(w,u[3]),e(c,Q),e(c,A),e(A,W),X||($=[z(l,"input",u[5]),z(m,"input",u[6]),z(i,"input",u[7]),z(w,"input",u[8]),z(c,"submit",ce(u[4]))],X=!0)},p(p,[h]){h&1&&l.value!==p[0]&&N(l,p[0]),h&2&&m.value!==p[1]&&N(m,p[1]),h&4&&i.value!==p[2]&&N(i,p[2]),h&8&&w.value!==p[3]&&N(w,p[3])},i:ae,o:ae,d(p){p&&f(c),X=!1,pe($)}}}function ve(u,c,s){let d,b,S;Y(u,he,o=>s(9,d=o)),Y(u,fe,o=>s(10,b=o)),Y(u,Z,o=>s(11,S=o));let y="",l="",_="",n="",I=b;const j=async()=>await fetch("https://backend.encrygen.co.uk/api/profiles/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+d},body:JSON.stringify({profile:{Institution:y,country:l,city:_,postcode:n,user:I}})}).then(o=>o),B=async()=>await fetch("https://backend.encrygen.co.uk/api/profiles/update/"+b,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token "+d},body:JSON.stringify({profile:{Institution:y,country:l,city:_,postcode:n,user:I}})}).then(o=>o),m=async()=>{if(console.log("submit"),S==!1)if((await j()).ok)Z.set(!0),location.reload();else throw new Error("An error has occured");else if((await B()).ok)Z.set(!0),location.reload();else throw new Error("An error has occured")};async function C(){if(S=="true")return await fetch("https://backend.encrygen.co.uk/api/profiles/show/"+b,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token "+d}}).then(o=>o)}de(async()=>{let o=await C();if(o.ok){let i=await o.json();s(0,y=i.Institution),s(1,l=i.country),s(2,_=i.city),s(3,n=i.postcode)}else alert("Rror: server error")});function E(){y=this.value,s(0,y)}function k(){l=this.value,s(1,l)}function T(){_=this.value,s(2,_)}function D(){n=this.value,s(3,n)}return[y,l,_,n,m,E,k,T,D]}class _e extends re{constructor(c){super();ne(this,c,ve,me,ie,{})}}export{_e as default};
