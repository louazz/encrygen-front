import{S as te,i as ae,s as re,e as i,t as w,k as D,c as f,a as u,h as A,d as l,m as H,b as G,g as Z,F as e,L as M,Z as Q,j as W,O as ne,G as X,_ as oe,K as $}from"../../chunks/vendor-022b7721.js";import{t as le,f as se}from"../../chunks/useToken-04409780.js";function x(r,t,_){const s=r.slice();return s[4]=t[_],s}function ee(r){let t,_,s,p=r[4]._id+"",j,L,h,m=new Date(r[4].created_at)+"",E,O,c,v,S,K,y,z,N,R,g,B,T,k,d;return{c(){t=i("tr"),_=i("td"),s=i("strong"),j=w(p),L=D(),h=i("td"),E=w(m),O=D(),c=i("td"),v=i("a"),S=w("Delete"),K=D(),y=i("a"),z=w("View"),R=D(),g=i("a"),B=w("regenerateKey"),T=D(),this.h()},l(a){t=f(a,"TR",{});var o=u(t);_=f(o,"TD",{});var n=u(_);s=f(n,"STRONG",{});var b=u(s);j=A(b,p),b.forEach(l),n.forEach(l),L=H(o),h=f(o,"TD",{});var P=u(h);E=A(P,m),P.forEach(l),O=H(o),c=f(o,"TD",{});var C=u(c);v=f(C,"A",{href:!0});var U=u(v);S=A(U,"Delete"),U.forEach(l),K=H(C),y=f(C,"A",{href:!0});var I=u(y);z=A(I,"View"),I.forEach(l),R=H(C),g=f(C,"A",{href:!0});var V=u(g);B=A(V,"regenerateKey"),V.forEach(l),C.forEach(l),T=H(o),o.forEach(l),this.h()},h(){G(v,"href","#"),G(y,"href",N="/document/"+encodeURI(r[4].encr)),G(g,"href","#")},m(a,o){Z(a,t,o),e(t,_),e(_,s),e(s,j),e(t,L),e(t,h),e(h,E),e(t,O),e(t,c),e(c,v),e(v,S),e(c,K),e(c,y),e(y,z),e(c,R),e(c,g),e(g,B),e(t,T),k||(d=[M(v,"click",function(){Q(r[1](r[4]._id))&&r[1](r[4]._id).apply(this,arguments)}),M(g,"click",function(){Q(r[2](r[4]._id))&&r[2](r[4]._id).apply(this,arguments)})],k=!0)},p(a,o){r=a,o&1&&p!==(p=r[4]._id+"")&&W(j,p),o&1&&m!==(m=new Date(r[4].created_at)+"")&&W(E,m),o&1&&N!==(N="/document/"+encodeURI(r[4].encr))&&G(y,"href",N)},d(a){a&&l(t),k=!1,ne(d)}}}function he(r){let t,_,s,p,j,L,h,m,E,O,c,v,S,K,y,z,N,R,g,B,T,k=r[0],d=[];for(let a=0;a<k.length;a+=1)d[a]=ee(x(r,k,a));return{c(){t=i("table"),_=i("thead"),s=i("tr"),p=i("th"),j=w("Documents"),L=D(),h=i("th"),m=i("a"),E=w("New"),O=D(),c=i("tr"),v=i("th"),S=w("id"),K=D(),y=i("th"),z=w("date"),N=D(),R=i("th"),g=w("action"),B=D(),T=i("tbody");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){t=f(a,"TABLE",{class:!0});var o=u(t);_=f(o,"THEAD",{});var n=u(_);s=f(n,"TR",{});var b=u(s);p=f(b,"TH",{colspan:!0});var P=u(p);j=A(P,"Documents"),P.forEach(l),L=H(b),h=f(b,"TH",{});var C=u(h);m=f(C,"A",{href:!0});var U=u(m);E=A(U,"New"),U.forEach(l),C.forEach(l),b.forEach(l),O=H(n),c=f(n,"TR",{});var I=u(c);v=f(I,"TH",{});var V=u(v);S=A(V,"id"),V.forEach(l),K=H(I),y=f(I,"TH",{});var F=u(y);z=A(F,"date"),F.forEach(l),N=H(I),R=f(I,"TH",{});var J=u(R);g=A(J,"action"),J.forEach(l),I.forEach(l),n.forEach(l),B=H(o),T=f(o,"TBODY",{});var Y=u(T);for(let q=0;q<d.length;q+=1)d[q].l(Y);Y.forEach(l),o.forEach(l),this.h()},h(){G(p,"colspan","2"),G(m,"href","/document"),G(t,"class","u-full-width")},m(a,o){Z(a,t,o),e(t,_),e(_,s),e(s,p),e(p,j),e(s,L),e(s,h),e(h,m),e(m,E),e(_,O),e(_,c),e(c,v),e(v,S),e(c,K),e(c,y),e(y,z),e(c,N),e(c,R),e(R,g),e(t,B),e(t,T);for(let n=0;n<d.length;n+=1)d[n].m(T,null)},p(a,[o]){if(o&7){k=a[0];let n;for(n=0;n<k.length;n+=1){const b=x(a,k,n);d[n]?d[n].p(b,o):(d[n]=ee(b),d[n].c(),d[n].m(T,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=k.length}},i:X,o:X,d(a){a&&l(t),oe(d,a)}}}function ce(r,t,_){let s,p;return $(r,le,h=>_(3,s=h)),$(r,se,h=>_(0,p=h)),[p,async h=>{await fetch("https://backend.encrygen.co.uk/api/docs/delete/"+h,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token "+s}}).then(m=>{alert("Deleted document"),location.reload()})},async h=>{let m=prompt("Please enter your new key:");const E=await self.fetch("https://backend.encrygen.co.uk/api/docs/update/"+h,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token "+s},body:JSON.stringify({doc:{key:m}})});if(E.ok)return alert("key has been updated successfully"),location.reload(),E.json();throw alert("internal server error or wrong inputs type"),new Error("server error")}]}class fe extends te{constructor(t){super();ae(this,t,ce,he,re,{})}}export{fe as default};
