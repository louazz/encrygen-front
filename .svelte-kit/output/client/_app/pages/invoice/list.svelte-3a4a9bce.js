import{S as te,i as ae,s as re,e as d,t as w,k as D,c as f,a as _,h as A,d as l,m as H,b as z,g as Y,F as e,M as $,_ as Q,j as W,P as ne,G as X,$ as oe,K as Z}from"../../chunks/vendor-b1e65c03.js";import{t as le,q as se}from"../../chunks/useToken-a1248fbf.js";function x(r,t,u){const s=r.slice();return s[4]=t[u],s}function ee(r){let t,u,s,p=r[4]._id+"",j,N,i,v=new Date(r[4].created_at)+"",g,K,h,m,L,O,E,P,S,I,y,q,T,k,c;return{c(){t=d("tr"),u=d("td"),s=d("strong"),j=w(p),N=D(),i=d("td"),g=w(v),K=D(),h=d("td"),m=d("a"),L=w("Delete"),O=D(),E=d("a"),P=w("View"),I=D(),y=d("a"),q=w("regenerateKey"),T=D(),this.h()},l(a){t=f(a,"TR",{});var o=_(t);u=f(o,"TD",{});var n=_(u);s=f(n,"STRONG",{});var b=_(s);j=A(b,p),b.forEach(l),n.forEach(l),N=H(o),i=f(o,"TD",{});var B=_(i);g=A(B,v),B.forEach(l),K=H(o),h=f(o,"TD",{});var R=_(h);m=f(R,"A",{href:!0});var G=_(m);L=A(G,"Delete"),G.forEach(l),O=H(R),E=f(R,"A",{href:!0});var C=_(E);P=A(C,"View"),C.forEach(l),I=H(R),y=f(R,"A",{href:!0});var U=_(y);q=A(U,"regenerateKey"),U.forEach(l),R.forEach(l),T=H(o),o.forEach(l),this.h()},h(){z(m,"href","#"),z(E,"href",S="/invoice/"+encodeURI(r[4].encr)),z(y,"href","#")},m(a,o){Y(a,t,o),e(t,u),e(u,s),e(s,j),e(t,N),e(t,i),e(i,g),e(t,K),e(t,h),e(h,m),e(m,L),e(h,O),e(h,E),e(E,P),e(h,I),e(h,y),e(y,q),e(t,T),k||(c=[$(m,"click",function(){Q(r[1](r[4]._id))&&r[1](r[4]._id).apply(this,arguments)}),$(y,"click",function(){Q(r[2](r[4]._id))&&r[2](r[4]._id).apply(this,arguments)})],k=!0)},p(a,o){r=a,o&1&&p!==(p=r[4]._id+"")&&W(j,p),o&1&&v!==(v=new Date(r[4].created_at)+"")&&W(g,v),o&1&&S!==(S="/invoice/"+encodeURI(r[4].encr))&&z(E,"href",S)},d(a){a&&l(t),k=!1,ne(c)}}}function ie(r){let t,u,s,p,j,N,i,v,g,K,h,m,L,O,E,P,S,I,y,q,T,k=r[0],c=[];for(let a=0;a<k.length;a+=1)c[a]=ee(x(r,k,a));return{c(){t=d("table"),u=d("thead"),s=d("tr"),p=d("th"),j=w("Invoices"),N=D(),i=d("th"),v=d("a"),g=w("New"),K=D(),h=d("tr"),m=d("th"),L=w("id"),O=D(),E=d("th"),P=w("date"),S=D(),I=d("th"),y=w("action"),q=D(),T=d("tbody");for(let a=0;a<c.length;a+=1)c[a].c();this.h()},l(a){t=f(a,"TABLE",{class:!0});var o=_(t);u=f(o,"THEAD",{});var n=_(u);s=f(n,"TR",{});var b=_(s);p=f(b,"TH",{colspan:!0});var B=_(p);j=A(B,"Invoices"),B.forEach(l),N=H(b),i=f(b,"TH",{});var R=_(i);v=f(R,"A",{href:!0});var G=_(v);g=A(G,"New"),G.forEach(l),R.forEach(l),b.forEach(l),K=H(n),h=f(n,"TR",{});var C=_(h);m=f(C,"TH",{});var U=_(m);L=A(U,"id"),U.forEach(l),O=H(C),E=f(C,"TH",{});var F=_(E);P=A(F,"date"),F.forEach(l),S=H(C),I=f(C,"TH",{});var J=_(I);y=A(J,"action"),J.forEach(l),C.forEach(l),n.forEach(l),q=H(o),T=f(o,"TBODY",{});var M=_(T);for(let V=0;V<c.length;V+=1)c[V].l(M);M.forEach(l),o.forEach(l),this.h()},h(){z(p,"colspan","2"),z(v,"href","/invoice#"),z(t,"class","u-full-width")},m(a,o){Y(a,t,o),e(t,u),e(u,s),e(s,p),e(p,j),e(s,N),e(s,i),e(i,v),e(v,g),e(u,K),e(u,h),e(h,m),e(m,L),e(h,O),e(h,E),e(E,P),e(h,S),e(h,I),e(I,y),e(t,q),e(t,T);for(let n=0;n<c.length;n+=1)c[n].m(T,null)},p(a,[o]){if(o&7){k=a[0];let n;for(n=0;n<k.length;n+=1){const b=x(a,k,n);c[n]?c[n].p(b,o):(c[n]=ee(b),c[n].c(),c[n].m(T,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=k.length}},i:X,o:X,d(a){a&&l(t),oe(c,a)}}}function he(r,t,u){let s,p;return Z(r,le,i=>u(3,s=i)),Z(r,se,i=>u(0,p=i)),[p,async i=>{await fetch("https://backend.encrygen.co.uk/api/invoices/delete/"+i,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token "+s}}).then(v=>{alert("Deleted invoice"),location.reload()})},async i=>{let v=prompt("Please enter your new key:");const g=await self.fetch("https://backend.encrygen.co.uk/api/invoices/update/"+i,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token "+s},body:JSON.stringify({invoice:{key:v}})});if(g.ok)return alert("key has been updated successfully"),location.reload(),g.json();throw alert("internal server error or wrong inputs type"),new Error("server error")}]}class fe extends te{constructor(t){super();ae(this,t,he,ie,re,{})}}export{fe as default};
