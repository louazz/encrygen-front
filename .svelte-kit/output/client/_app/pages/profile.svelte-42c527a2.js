import{S as re,i as ne,s as ie,e as l,t as O,k as A,c as r,a as v,h as V,d as h,m as L,b as t,g as ue,F as e,N,M as z,O as ce,G as le,P as pe,K as Y,v as de}from"../chunks/vendor-b1e65c03.js";import{t as fe,i as he,p as Z}from"../chunks/useToken-a1248fbf.js";function me(u){let c,s,d,b,S,y,a,_,n,I,j,B,m,C,E,k,T,D,o,i,q,g,U,x,H,w,Q,P,W,X,$;return{c(){c=l("form"),s=l("div"),d=l("div"),b=l("label"),S=O("Institution"),y=A(),a=l("input"),_=A(),n=l("div"),I=l("label"),j=O("country"),B=A(),m=l("input"),C=A(),E=l("div"),k=l("div"),T=l("label"),D=O("city"),o=A(),i=l("input"),q=A(),g=l("div"),U=l("label"),x=O("postcode"),H=A(),w=l("input"),Q=A(),P=l("button"),W=O("Submit"),this.h()},l(p){c=r(p,"FORM",{});var f=v(c);s=r(f,"DIV",{class:!0});var M=v(s);d=r(M,"DIV",{class:!0});var R=v(d);b=r(R,"LABEL",{for:!0});var ee=v(b);S=V(ee,"Institution"),ee.forEach(h),y=L(R),a=r(R,"INPUT",{class:!0,type:!0,placeholder:!0}),R.forEach(h),_=L(M),n=r(M,"DIV",{class:!0});var F=v(n);I=r(F,"LABEL",{for:!0});var te=v(I);j=V(te,"country"),te.forEach(h),B=L(F),m=r(F,"INPUT",{class:!0,type:!0,placeholder:!0}),F.forEach(h),M.forEach(h),C=L(f),E=r(f,"DIV",{class:!0});var G=v(E);k=r(G,"DIV",{class:!0});var J=v(k);T=r(J,"LABEL",{for:!0});var se=v(T);D=V(se,"city"),se.forEach(h),o=L(J),i=r(J,"INPUT",{class:!0,type:!0,placeholder:!0}),J.forEach(h),q=L(G),g=r(G,"DIV",{class:!0});var K=v(g);U=r(K,"LABEL",{for:!0});var oe=v(U);x=V(oe,"postcode"),oe.forEach(h),H=L(K),w=r(K,"INPUT",{class:!0,type:!0,placeholder:!0}),K.forEach(h),G.forEach(h),Q=L(f),P=r(f,"BUTTON",{class:!0,type:!0});var ae=v(P);W=V(ae,"Submit"),ae.forEach(h),f.forEach(h),this.h()},h(){t(b,"for","exampleEmailInput"),t(a,"class","u-full-width"),t(a,"type","text"),t(a,"placeholder","Birkbeck College"),t(d,"class","six columns"),t(I,"for","exampleEmailInput"),t(m,"class","u-full-width"),t(m,"type","text"),t(m,"placeholder","England, UK"),t(n,"class","six columns"),t(s,"class","row"),t(T,"for","exampleEmailInput"),t(i,"class","u-full-width"),t(i,"type","text"),t(i,"placeholder","London"),t(k,"class","six columns"),t(U,"for","exampleEmailInput"),t(w,"class","u-full-width"),t(w,"type","text"),t(w,"placeholder","N1 6RU"),t(g,"class","six columns"),t(E,"class","row"),t(P,"class","button-primary"),t(P,"type","submit"),P.value="Submit"},m(p,f){ue(p,c,f),e(c,s),e(s,d),e(d,b),e(b,S),e(d,y),e(d,a),N(a,u[0]),e(s,_),e(s,n),e(n,I),e(I,j),e(n,B),e(n,m),N(m,u[1]),e(c,C),e(c,E),e(E,k),e(k,T),e(T,D),e(k,o),e(k,i),N(i,u[2]),e(E,q),e(E,g),e(g,U),e(U,x),e(g,H),e(g,w),N(w,u[3]),e(c,Q),e(c,P),e(P,W),X||($=[z(a,"input",u[5]),z(m,"input",u[6]),z(i,"input",u[7]),z(w,"input",u[8]),z(c,"submit",ce(u[4]))],X=!0)},p(p,[f]){f&1&&a.value!==p[0]&&N(a,p[0]),f&2&&m.value!==p[1]&&N(m,p[1]),f&4&&i.value!==p[2]&&N(i,p[2]),f&8&&w.value!==p[3]&&N(w,p[3])},i:le,o:le,d(p){p&&h(c),X=!1,pe($)}}}function ve(u,c,s){let d,b,S;Y(u,fe,o=>s(9,d=o)),Y(u,he,o=>s(10,b=o)),Y(u,Z,o=>s(11,S=o));let y="",a="",_="",n="",I=b;const j=async()=>await fetch("https://backend.encrygen.co.uk/api/profiles/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token "+d},body:JSON.stringify({profile:{Institution:y,country:a,city:_,postcode:n,user:I}})}).then(o=>o),B=async()=>await fetch("https://backend.encrygen.co.uk/api/profiles/update/"+b,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token "+d},body:JSON.stringify({profile:{Institution:y,country:a,city:_,postcode:n,user:I}})}).then(o=>o),m=async()=>{if(console.log("submit"),S==!1)if((await j()).ok)Z.set(!0),location.reload();else throw new Error("An error has occured");else if((await B()).ok)Z.set(!0),location.reload();else throw new Error("An error has occured")};async function C(){if(S=="true")return await fetch("https://backend.encrygen.co.uk/api/profiles/show/"+b,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token "+d}}).then(o=>o)}de(async()=>{let o=await C();if(o.ok){let i=await o.json();s(0,y=i.Institution),s(1,a=i.country),s(2,_=i.city),s(3,n=i.postcode)}else alert("Rror: server error")});function E(){y=this.value,s(0,y)}function k(){a=this.value,s(1,a)}function T(){_=this.value,s(2,_)}function D(){n=this.value,s(3,n)}return[y,a,_,n,m,E,k,T,D]}class _e extends re{constructor(c){super();ne(this,c,ve,me,ie,{})}}export{_e as default};
