import{S as te,i as ae,s as re,e as i,t as w,k as D,c as f,a as u,h as A,d as l,m as H,b as B,g as Y,F as e,M as $,_ as Q,j as W,P as ne,G as X,$ as oe,K as Z}from"../../chunks/vendor-b1e65c03.js";import{t as le,f as se}from"../../chunks/useToken-a1248fbf.js";function x(r,t,_){const s=r.slice();return s[4]=t[_],s}function ee(r){let t,_,s,p=r[4]._id+"",j,N,h,m=new Date(r[4].created_at)+"",E,K,c,v,L,O,y,P,S,R,g,z,T,k,d;return{c(){t=i("tr"),_=i("td"),s=i("strong"),j=w(p),N=D(),h=i("td"),E=w(m),K=D(),c=i("td"),v=i("a"),L=w("Delete"),O=D(),y=i("a"),P=w("View"),R=D(),g=i("a"),z=w("regenerateKey"),T=D(),this.h()},l(a){t=f(a,"TR",{});var o=u(t);_=f(o,"TD",{});var n=u(_);s=f(n,"STRONG",{});var b=u(s);j=A(b,p),b.forEach(l),n.forEach(l),N=H(o),h=f(o,"TD",{});var G=u(h);E=A(G,m),G.forEach(l),K=H(o),c=f(o,"TD",{});var C=u(c);v=f(C,"A",{href:!0});var U=u(v);L=A(U,"Delete"),U.forEach(l),O=H(C),y=f(C,"A",{href:!0});var I=u(y);P=A(I,"View"),I.forEach(l),R=H(C),g=f(C,"A",{href:!0});var V=u(g);z=A(V,"regenerateKey"),V.forEach(l),C.forEach(l),T=H(o),o.forEach(l),this.h()},h(){B(v,"href","#"),B(y,"href",S="/document/"+encodeURI(r[4].encr)),B(g,"href","#")},m(a,o){Y(a,t,o),e(t,_),e(_,s),e(s,j),e(t,N),e(t,h),e(h,E),e(t,K),e(t,c),e(c,v),e(v,L),e(c,O),e(c,y),e(y,P),e(c,R),e(c,g),e(g,z),e(t,T),k||(d=[$(v,"click",function(){Q(r[1](r[4]._id))&&r[1](r[4]._id).apply(this,arguments)}),$(g,"click",function(){Q(r[2](r[4]._id))&&r[2](r[4]._id).apply(this,arguments)})],k=!0)},p(a,o){r=a,o&1&&p!==(p=r[4]._id+"")&&W(j,p),o&1&&m!==(m=new Date(r[4].created_at)+"")&&W(E,m),o&1&&S!==(S="/document/"+encodeURI(r[4].encr))&&B(y,"href",S)},d(a){a&&l(t),k=!1,ne(d)}}}function he(r){let t,_,s,p,j,N,h,m,E,K,c,v,L,O,y,P,S,R,g,z,T,k=r[0],d=[];for(let a=0;a<k.length;a+=1)d[a]=ee(x(r,k,a));return{c(){t=i("table"),_=i("thead"),s=i("tr"),p=i("th"),j=w("Documents"),N=D(),h=i("th"),m=i("a"),E=w("New"),K=D(),c=i("tr"),v=i("th"),L=w("id"),O=D(),y=i("th"),P=w("date"),S=D(),R=i("th"),g=w("action"),z=D(),T=i("tbody");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){t=f(a,"TABLE",{class:!0});var o=u(t);_=f(o,"THEAD",{});var n=u(_);s=f(n,"TR",{});var b=u(s);p=f(b,"TH",{colspan:!0});var G=u(p);j=A(G,"Documents"),G.forEach(l),N=H(b),h=f(b,"TH",{});var C=u(h);m=f(C,"A",{href:!0});var U=u(m);E=A(U,"New"),U.forEach(l),C.forEach(l),b.forEach(l),K=H(n),c=f(n,"TR",{});var I=u(c);v=f(I,"TH",{});var V=u(v);L=A(V,"id"),V.forEach(l),O=H(I),y=f(I,"TH",{});var F=u(y);P=A(F,"date"),F.forEach(l),S=H(I),R=f(I,"TH",{});var J=u(R);g=A(J,"action"),J.forEach(l),I.forEach(l),n.forEach(l),z=H(o),T=f(o,"TBODY",{});var M=u(T);for(let q=0;q<d.length;q+=1)d[q].l(M);M.forEach(l),o.forEach(l),this.h()},h(){B(p,"colspan","2"),B(m,"href","/document"),B(t,"class","u-full-width")},m(a,o){Y(a,t,o),e(t,_),e(_,s),e(s,p),e(p,j),e(s,N),e(s,h),e(h,m),e(m,E),e(_,K),e(_,c),e(c,v),e(v,L),e(c,O),e(c,y),e(y,P),e(c,S),e(c,R),e(R,g),e(t,z),e(t,T);for(let n=0;n<d.length;n+=1)d[n].m(T,null)},p(a,[o]){if(o&7){k=a[0];let n;for(n=0;n<k.length;n+=1){const b=x(a,k,n);d[n]?d[n].p(b,o):(d[n]=ee(b),d[n].c(),d[n].m(T,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=k.length}},i:X,o:X,d(a){a&&l(t),oe(d,a)}}}function ce(r,t,_){let s,p;return Z(r,le,h=>_(3,s=h)),Z(r,se,h=>_(0,p=h)),[p,async h=>{await fetch("https://backend.encrygen.co.uk/api/docs/delete/"+h,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Token "+s}}).then(m=>{alert("Deleted document"),location.reload()})},async h=>{let m=prompt("Please enter your new key:");const E=await self.fetch("https://backend.encrygen.co.uk/api/docs/update/"+h,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token "+s},body:JSON.stringify({doc:{key:m}})});if(E.ok)return alert("key has been updated successfully"),location.reload(),E.json();throw alert("internal server error or wrong inputs type"),new Error("server error")}]}class fe extends te{constructor(t){super();ae(this,t,ce,he,re,{})}}export{fe as default};
